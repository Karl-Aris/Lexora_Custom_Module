<odoo>
    <record id="view_order_form_inherit_delivery_tracking" model="ir.ui.view">
        <field name="name">sale.order.form.delivery.tracking</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//sheet/notebook" position="inside">
                <page string="Delivery Tracking" name="delivery_tracking">
                    <group>
                        <group>
                            <field name="delivery_status"/>
                            <field name="etd"/>
                            <field name="actual_delivery_date"/>
                        </group>
                        <group>
                            <field name="follow_up_required"/>
                            <field name="contacted"/>
                            <field name="contact_notes"/>
                        </group>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <record id="view_sale_order_filter_delivery_tracking" model="ir.ui.view">
        <field name="name">sale.order.search.delivery.tracking</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_quotation_tree_with_search"/>
        <field name="arch" type="xml">
            <xpath expr="//search" position="inside">

                <!-- 1. ETD Missing -->
                <filter name="etd_missing" string="ETD Missing"
                        domain="[['|', ('delivery_status', '=', False), ('delivery_status', '=', 'not_delivered')],
                                 ('etd', '=', False),
                                 ('carrier_tracking_ref', '!=', False),
                                 ('carrier_id', '!=', False)]"/>

                <!-- 2. Missed ETD – Not Delivered -->
                <filter name="missed_etd_not_delivered" string="Missed ETD - Not Delivered"
                        domain="[('etd', '&lt;', context_today()),
                                 ('delivery_status', '=', 'not_delivered'),
                                 ('carrier_tracking_ref', '!=', False),
                                 ('carrier_id', '!=', False)]"/>

                <!-- 3. Same-Day ETD – Not Delivered Yet -->
                <filter name="same_day_etd_not_delivered" string="Same-Day ETD - Not Delivered Yet"
                        domain="[('etd', '=', context_today()),
                                 ('delivery_status', '=', 'not_delivered'),
                                 ('carrier_tracking_ref', '!=', False),
                                 ('carrier_id', '!=', False)]"/>

                <!-- 4. Delivered – Not Contacted -->
                <filter name="delivered_not_contacted" string="Delivered - Not Contacted"
                        domain="[('delivery_status', '=', 'delivered'),
                                 ('contacted', '=', False),
                                 ('carrier_tracking_ref', '!=', False),
                                 ('carrier_id', '!=', False)]"/>

                <!-- 5. Delivered – Contacted but Notes Present -->
                <filter name="delivered_contacted_notes" string="Delivered - Contacted w/ Notes"
                        domain="[('delivery_status', '=', 'delivered'),
                                 ('contact_notes', '!=', False)]"/>

                <!-- 6. Follow-Up Required – Open -->
                <filter name="follow_up_required_open" string="Follow-Up Required - Open"
                        domain="[('follow_up_required', '=', True),
                                 '|', ('delivery_status', '!=', 'delivered'), ('contacted', '=', False)]"/>

                <!-- 7. Actual Delivery Date Missing -->
                <filter name="actual_delivery_date_missing" string="Delivered - Missing Actual Date"
                        domain="[('delivery_status', '=', 'delivered'),
                                 ('actual_delivery_date', '=', False)]"/>

                <!-- 8. Delivery Status Missing -->
                <filter name="delivery_status_missing" string="Delivery Status Missing"
                        domain="[('delivery_status', '=', False),
                                 ('carrier_tracking_ref', '!=', False),
                                 ('carrier_id', '!=', False)]"/>

                <!-- 9. ETD Today & Delivered but Not Contacted -->
                <filter name="etd_today_delivered_not_contacted" string="ETD Today & Delivered - Not Contacted"
                        domain="[('etd', '=', context_today()),
                                 ('delivery_status', '=', 'delivered'),
                                 ('contacted', '=', False),
                                 ('carrier_tracking_ref', '!=', False),
                                 ('carrier_id', '!=', False)]"/>

            </xpath>
        </field>
    </record>
</odoo>
