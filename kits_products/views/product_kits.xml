<odoo>
    <template id="kit_group_detail_template" name="Kit Group Detail">
        <t t-call="website.layout">
            <div class="container py-5">

                <div class="row g-5">
                    <!-- Left Column: Main Product -->
                    <div class="col-lg-6">
                        <div class="card  border-0 h-100">
                            <div class="card-body">

                                <t t-if="kit and product">
                                    <!-- Breadcrumb / Product Path -->
                                    <p class="text-muted small mb-2">
                                        <a t-att-href="'/product_kits'" class="text-decoration-none text-muted">All Products</a> /
                                        <t t-esc="product.name" />
                                    </p>


                                    <!-- Product Image -->
                                    <div class="text-center mb-4">
                                        <img t-att-src="'/web/image/product.product/' + str(product.id) + '/image_1920'" alt="Product Image" class="img-fluid rounded  " style="height: 400px; object-fit: cover;" />
                                    </div>

                                    <!-- Product Name -->
                                    <h5 class="fw-semibold mb-2 text-start">
                                        <t t-esc="product.name" />
                                    </h5>

                                    <!-- Product Description -->
                                    <p class="text-muted small text-center mb-3">
                                        <t t-esc="product.description_sale" />
                                    </p>

                                    <!-- Product Price -->
                                    <p class="fs-5 fw-semibold text-start">
                    Price: <t t-esc="product.lst_price and ('%.2f' % product.lst_price) or 'N/A'" />
                                    </p>



                                    <!-- Add to Cart -->
                                    <t t-if="kit.product_id">
                                        <form action="/shop/cart/update" method="post" class="mt-4">
                                            <input type="hidden" name="product_id" t-att-value="kit.product_id.id" />
                                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />

                                            <div class="d-flex flex-wrap align-items-center gap-3">
                                                <!-- Quantity Input -->
                                                <div class="input-group quantity-group rounded   " style="width: 160px; height: 44px;">
                                                    <!-- Minus Button -->
                                                    <button type="button" class="btn btn-outline-secondary border-1 shadow-sm  px-3" aria-label="Decrease quantity" onclick="let input = this.parentNode.querySelector('input[name=add_qty]'); if (input.value > 1) input.stepDown();">âˆ’</button>

                                                    <!-- Number Input -->
                                                    <input name="add_qty" type="number" class="form-control  shadow-sm text-center border " value="1" min="1" aria-label="Quantity" style="font-size: 1rem; max-width: 60px;" />

                                                    <!-- Plus Button -->
                                                    <button type="button" class="btn shadow-sm  btn-outline-secondary border-1 px-3" aria-label="Increase quantity" onclick="this.parentNode.querySelector('input[name=add_qty]').stepUp()">+</button>
                                                </div>

                                                <!-- Add to Cart Button -->
                                                <button type="submit" class="btn btn-dark d-flex align-items-center justify-content-center fw-semibold shadow-sm" style="min-width: 250px; height: 44px;">
                                                    <i class="fa fa-cart-plus me-2"></i> Add to Cart
                                                </button>
                                            </div>
                                        </form>

                                    </t>
                                    <t t-else="">
                                        <div class=" text-start mt-4">
                                            <p class="text-muted small mb-2">
                                                <a t-att-href="'/product_kits'" class="text-decoration-none text-muted">All Products</a> /
                                            
                                            </p>

                                        </div>
                                        <div class="alert alert-warning text-center mt-4">
                                            <div class="text-center py-5">
                                                <img t-att-src="'/kits_products/static/description/no-order.png'" alt="No Kit" style="width: 50px; opacity: 0.3;" />
                                                <h5 class="mt-3 text-muted">             Product not available for sale</h5>
                                            </div>

                                        </div>
                                    </t>
                                </t>

                                <!-- KIT FOUND BUT NO MATCHING PRODUCT -->
                                <t t-if="kit and not product">
                                    <div class=" text-start mt-4">
                                        <p class="text-muted small mb-2">
                                            <a t-att-href="'/product_kits'" class="text-decoration-none text-muted">All Products</a> /
                                            
                                        </p>

                                    </div>
                                    <div class="text-center py-5">

                                        <img t-att-src="'/kits_products/static/description/no-order.png'" alt="No Kit" style="width: 50px; opacity: 0.3;" />
                                        <h5 class="mt-3 text-muted">No matching product variant available</h5>
                                    </div>
                                </t>

                                <!-- NO KIT MATCH -->
                                <t t-if="not kit">
                                    <div class=" text-start mt-4">
                                        <p class="text-muted small mb-2">
                                            <a t-att-href="'/product_kits'" class="text-decoration-none text-muted">All Products</a> /
                                            
                                        </p>

                                    </div>
                                    <div class="text-center py-5">

                                        <img t-att-src="'/kits_products/static/description/no-order.png'" alt="No Kit" style="width: 50px; opacity: 0.3;" />
                                        <h5 class="mt-3 text-muted">No matching kit found for this selection</h5>
                                    </div>



                                </t>
                                <div
>
                                    <t t-if="product and product.product_tmpl_id and product.product_tmpl_id.valid_product_template_attribute_line_ids">

                                        <div class="mt-4">
                                            <h3 class="fw-bold mb-2">Specifications</h3>
                                            <table class="table table-sm spec-table">
                                                <tbody>
                                                    <t t-foreach="product.product_tmpl_id.valid_product_template_attribute_line_ids" t-as="ptal">
                                                        <tr t-if="ptal.value_ids">
                                                            <td class="fw-semibold w-25">
                                                                <t t-esc="ptal.attribute_id.name" />
                                                            </td>
                                                            <td class="text-muted w-75">
                                                                <t t-foreach="ptal.product_template_value_ids._only_active()" t-as="ptv" t-separator=", ">
                                                                    <t t-esc="ptv.name" />
                                                                </t>
                                                            </td>
                                                        </tr>
                                                    </t>
                                                </tbody>
                                            </table>
                                        </div>
                                    </t>
                                </div>
                            </div>


                        </div>
                    </div>


                    <!-- Right Column: Components -->
                    <div class="col-lg-6">
                        <!-- Cabinet Sizes -->
                        <t t-if="related_kits">
                            <t t-set="shown_sizes" t-value="[]" />

                            <div class="mb-4">
                                <h4 class="mb-3 fw-bold border-bottom pb-2 text-primary">
                                    <i class="fa fa-expand-arrows-alt me-1"></i>
                                    <span class="d-inline-flex align-items-center justify-content-center bg-black text-white rounded-circle" style="width: 30px; height: 30px; font-size: 14px;">
  1
                                    </span>


        Select Cabinet Size
                                </h4>

                                <div class="row row-cols-2 row-cols-sm-3 row-cols-md-4 row-cols-lg-5 g-3">
                                    <t t-foreach="related_kits" t-as="rel_kit">
                                        <t t-if="rel_kit.size not in shown_sizes">
                                            <t t-set="shown_sizes" t-value="shown_sizes + [rel_kit.size]" />
                                            <div class="col">
                                                <div class="card h-100 border-0 shadow-sm text-center">
                                                    <a t-att-href="'/product_kits/group?collection=%s&amp;size=%s' % (rel_kit.collection or '', rel_kit.size or '')">
                                                        <div class="d-flex justify-content-center align-items-center p-2" style="height: 90px;">
                                                            <img t-att-src="'/web/image/product.product/' + str(rel_kit.product_id.id) + '/image_1920'" class="img-fluid rounded" style="max-height: 80px; object-fit: cover;" alt="Size Image" />
                                                        </div>
                                                    </a>
                                                    <div class="card-body p-2">
                                                        <h6 class="mb-0">
                                                            <a t-att-href="'/product_kits/group?collection=%s&amp;size=%s' % (rel_kit.collection or '', rel_kit.size or '')" class="text-decoration-none text-dark">
                                                                <t t-esc="rel_kit.size" />
                                                            </a>
                                                        </h6>
                                                    </div>
                                                </div>
                                            </div>
                                        </t>
                                    </t>
                                </div>
                            </div>
                        </t>

                        <!-- Components Section -->
                        <t t-foreach="['cabinet', 'counter_top', 'mirror', 'faucet']" t-as="category">
                            <t t-if="components[category]">
                                <div class="mb-3">                                    <!-- Reduced mb-5 to mb-3 -->
                                    <div class="d-flex justify-content-between align-items-center mb-2 border-bottom pb-1">                                        <!-- mb-3 to mb-2, pb-2 to pb-1 -->
                                        <h4 class="mb-0 fw-semibold" style="font-size: 1rem;">                                            <!-- Optional: Smaller heading -->
                                            <t t-if="category == 'cabinet'">
                                                <span class="d-inline-flex align-items-center justify-content-center bg-black text-white rounded-circle" style="width: 24px; height: 24px; font-size: 12px;">
2
                                                </span> Color
                                            </t>
                                            <t t-if="category == 'counter_top'">
                                                <span class="d-inline-flex align-items-center justify-content-center bg-black text-white rounded-circle" style="width: 24px; height: 24px; font-size: 12px;">
3
                                                </span> Counter Top
                                            </t>
                                            <t t-if="category == 'mirror'">
                                                <span class="d-inline-flex align-items-center justify-content-center bg-black text-white rounded-circle" style="width: 24px; height: 24px; font-size: 12px;">
4
                                                </span> Mirror
                                            </t>
                                            <t t-if="category == 'faucet'">
                                                <span class="d-inline-flex align-items-center justify-content-center bg-black text-white rounded-circle" style="width: 24px; height: 24px; font-size: 12px;">
5
                                                </span> Faucet
                                            </t>
                                        </h4>
                                    </div>

                                    <div class="row g-2">                                        <!-- Reduced gutter spacing from g-3 to g-2 -->
                                        <t t-foreach="components[category]" t-as="comp">
                                            <t t-if="category == 'cabinet'">
                                                <span>DEBUG CABINET: <t t-esc="comp.id" />
                                                </span>
                                            </t>
                                            <div class="col-6 col-sm-4 col-lg-3">
                                                <a t-att-href="'/product_kits/group?collection=%s&amp;size=%s&amp;cabinet=%s&amp;counter_top=%s&amp;mirror=%s&amp;faucet=%s' % (
                            collection, size or '',
                            ('' if category == 'cabinet' and cabinet == comp.id else (comp.id if category == 'cabinet' else cabinet or '')),
                            ('' if category == 'counter_top' and counter_top == comp.id else (comp.id if category == 'counter_top' else counter_top or '')),
                            ('' if category == 'mirror' and mirror == comp.id else (comp.id if category == 'mirror' else mirror or '')),
                            ('' if category == 'faucet' and faucet == comp.id else (comp.id if category == 'faucet' else faucet or ''))
                        )" class="text-decoration-none">
                                                    <div t-attf-class="card h-100 rounded-3 #{'border border-primary shadow' if ((category == 'cabinet' and comp.id == cabinet) or (category == 'counter_top' and comp.id == counter_top) or (category == 'mirror' and comp.id == mirror) or (category == 'faucet' and comp.id == faucet)) else 'border-light shadow-sm'}" style="transition: transform 0.2s; cursor: pointer; padding: 6px;">                                                        <!-- Optional: add small padding -->
                                                        <div class="d-flex justify-content-center align-items-center" style="height: 100px;">                                                            <!-- reduced from 120px -->
                                                            <img t-att-src="comp.image_1920 and '/web/image/product.product/' + str(comp.id) + '/image_1920' or ''" class="img-fluid rounded" style="max-height: 70px; object-fit: cover;" />
                                                        </div>
                                                        <div class="card-body p-1 text-center">                                                            <!-- reduced padding -->
                                                            <small class="text-muted d-block" style="font-size: 10px;">
                                                                <t t-esc="comp.default_code or 'No SKU'" />
                                                            </small>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        </t>
                                    </div>
                                </div>
                            </t>
                        </t>

                    </div>
                </div>

                <!-- Reset Button -->
                <div class="mt-4 text-end">
                    <a t-att-href="'/product_kits/group?collection=%s&amp;size=%s' % (collection, size or '')" class="btn btn-outline-secondary">Reset Selection</a>
                </div>

            </div>



        </t>

    </template>



</odoo>