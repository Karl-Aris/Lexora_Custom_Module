<odoo>
    <!-- Form View: Delivery Tracking fields -->
    <record id="view_order_form_inherit_delivery_tracking" model="ir.ui.view">
        <field name="name">sale.order.form.delivery.tracking</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='other_information']/group" position="inside">
                <group string="Delivery Tracking">
                    <field name="x_delivery_status"/>
                    <field name="x_etd"/>
                    <field name="x_follow_up_required"/>
                    <field name="x_actual_delivery_date"/>
                    <field name="x_contacted"/>
                    <field name="x_contact_notes"/>
                </group>
            </xpath>
        </field>
    </record>

    <!-- Search View: Custom Filters under Delivery Tracking -->
    <record id="sale_order_search_inherit_delivery_tracking" model="ir.ui.view">
        <field name="name">sale.order.search.inherit.delivery.tracking</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_sales_order_filter"/>
        <field name="arch" type="xml">
            <field name="partner_id" position="after">
                <group expand="0" string="Delivery Tracking">

                    <filter string="Actual Delivery Date Missing"
                            name="actual_delivery_date_missing"
                            domain="[('x_delivery_status','=','delivered'), ('x_actual_delivery_date','=',False)]"/>

                    <filter string="Delivered – Contacted but Notes Present"
                            name="delivered_contacted_notes"
                            domain="[('x_delivery_status','=','delivered'), ('x_contacted','=',True), ('x_contact_notes','!=',False)]"/>

                    <filter string="Delivered – Not Contacted"
                            name="delivered_not_contacted"
                            domain="[('x_delivery_status','=','delivered'), ('x_contacted','=',False), ('x_studio_carrier','!=',False), ('carrier_tracking_ref','!=',False)]"/>

                    <filter string="Delivery Status Missing"
                            name="delivery_status_missing"
                            domain="[('x_delivery_status','=',False), ('carrier_tracking_ref','!=',False), ('x_studio_carrier','!=',False)]"/>

                    <filter string="ETD Missed - Not Delivered"
                            name="etd_missed_not_delivered"
                            domain="[('x_etd','=','today'), ('x_delivery_status','=',False), ('x_studio_carrier','!=',False), ('carrier_tracking_ref','!=',False)]"/>

                    <filter string="ETD Missing"
                            name="etd_missing"
                            domain="[('x_etd','=',False), ('x_studio_carrier','!=',False), ('carrier_tracking_ref','!=',False), ('x_delivery_status','=',False)]"/>

                    <filter string="ETD Same Day - Not Yet Delivered"
                            name="etd_same_day_not_delivered"
                            domain="[('x_etd','=','today'), ('x_delivery_status','=',False), ('x_studio_carrier','!=',False), ('carrier_tracking_ref','!=',False)]"/>

                    <filter string="ETD Today & Delivered but Not Contacted"
                            name="etd_today_delivered_not_contacted"
                            domain="[('x_etd','=','today'), ('x_delivery_status','=','delivered'), ('x_contacted','=',False), ('carrier_tracking_ref','!=',False), ('x_studio_carrier','!=',False)]"/>

                    <filter string="Follow-Up Required – Open"
                            name="follow_up_required_open"
                            domain="[('x_follow_up_required','=',True), ('x_delivery_status','=',False), ('x_contacted','=',False)]"/>

                </group>
            </field>
        </field>
    </record>
</odoo>
